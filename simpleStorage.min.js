/*! simpleStorage v0.2.1a, Unlicense 2022. https://github.com/helgispbru/simpleStorage */
!function(e,t){"use strict";"function"==typeof define&&define.amd?define(t):"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():e.simpleStorage=t()}(this,function(){"use strict";var _=!1,t=0,r=!1,s=null,a="OK",o="LS_NOT_AVAILABLE",i="LS_DISABLED",n="LS_QUOTA_EXCEEDED";function m(){try{e()}catch(e){return void(r=!1)}p()}function e(){var e=localStorage.getItem("simpleStorage");try{_=JSON.parse(e)||{}}catch(e){_={}}t=g()}function l(){try{localStorage.setItem("simpleStorage",JSON.stringify(_)),t=g()}catch(e){return S(e)}return!0}function g(){var e=localStorage.getItem("simpleStorage");return e?String(e).length:0}function p(){var e,t,r,a,o,i=1/0,n=0;if(clearTimeout(s),_&&_.__simpleStorage_meta&&_.__simpleStorage_meta.TTL){for(e=+new Date,o=_.__simpleStorage_meta.TTL.keys||[],a=_.__simpleStorage_meta.TTL.expire||{},t=0,r=o.length;t<r;t++){if(!(a[o[t]]<=e)){a[o[t]]<i&&(i=a[o[t]]);break}n++,delete _[o[t]],delete a[o[t]]}i!==1/0&&(s=setTimeout(p,Math.min(i-e,2147483647))),n&&(o.splice(0,n),T(),l())}}function c(e,t){var r,a,o=+new Date,i=!1;if(0!==(t=Number(t)||0)){if(!_.hasOwnProperty(e))return;if(_.__simpleStorage_meta||(_.__simpleStorage_meta={}),_.__simpleStorage_meta.TTL||(_.__simpleStorage_meta.TTL={expire:{},keys:[]}),_.__simpleStorage_meta.TTL.expire[e]=o+t,_.__simpleStorage_meta.TTL.expire.hasOwnProperty(e))for(r=0,a=_.__simpleStorage_meta.TTL.keys.length;r<a;r++)_.__simpleStorage_meta.TTL.keys[r]===e&&_.__simpleStorage_meta.TTL.keys.splice(r);for(r=0,a=_.__simpleStorage_meta.TTL.keys.length;r<a;r++)if(_.__simpleStorage_meta.TTL.expire[_.__simpleStorage_meta.TTL.keys[r]]>o+t){_.__simpleStorage_meta.TTL.keys.splice(r,0,e),i=!0;break}i||_.__simpleStorage_meta.TTL.keys.push(e)}else if(_&&_.__simpleStorage_meta&&_.__simpleStorage_meta.TTL){if(_.__simpleStorage_meta.TTL.expire.hasOwnProperty(e))for(delete _.__simpleStorage_meta.TTL.expire[e],r=0,a=_.__simpleStorage_meta.TTL.keys.length;r<a;r++)if(_.__simpleStorage_meta.TTL.keys[r]===e){_.__simpleStorage_meta.TTL.keys.splice(r,1);break}T()}return clearTimeout(s),_&&_.__simpleStorage_meta&&_.__simpleStorage_meta.TTL&&_.__simpleStorage_meta.TTL.keys.length&&(s=setTimeout(p,Math.min(Math.max(_.__simpleStorage_meta.TTL.expire[_.__simpleStorage_meta.TTL.keys[0]]-o,0),2147483647))),1}function T(){var e,t=!1,r=!1;if(!_||!_.__simpleStorage_meta)return t;for(e in _.__simpleStorage_meta.TTL&&!_.__simpleStorage_meta.TTL.keys.length&&(delete _.__simpleStorage_meta.TTL,t=!0),_.__simpleStorage_meta)if(_.__simpleStorage_meta.hasOwnProperty(e)){r=!0;break}return r||(delete _.__simpleStorage_meta,t=!0),t}function S(e){var t;return 22===e.code||1014===e.code||0<[-2147024882,-2146828281,-21474675259].indexOf(e.number)?((t=new Error("localStorage quota exceeded")).code=n,t):18===e.code||1e3===e.code||"TypeError"===e.name?((t=new Error("localStorage is disabled")).code=i,t):e}try{r=function(){var t,r=0;if(null===window.localStorage||"unknown"==typeof window.localStorage)throw(t=new Error("localStorage is disabled")).code=i,t;if(!window.localStorage)throw(t=new Error("localStorage not supported")).code=o,t;try{r=window.localStorage.length}catch(e){throw S(e)}try{window.localStorage.setItem("__simpleStorageInitTest",(+new Date).toString(16)),window.localStorage.removeItem("__simpleStorageInitTest")}catch(e){throw r?S(e):((t=new Error("localStorage is disabled")).code=i,t)}return!0}(),e(),p(),"addEventListener"in window?window.addEventListener("storage",m,!1):document.attachEvent("onstorage",m),"addEventListener"in window&&window.addEventListener("pageshow",function(e){e.persisted&&m()},!1),r=!0}catch(e){!function(e){if(!e)return a="OK";switch(e.code){case o:case i:case n:a=e.code;break;default:a=e.code||e.number||e.message||e.name}}(e)}return{version:"0.2.1a",status:a,canUse:function(){return"OK"===a&&!!r},set:function(e,t,r){if("__simpleStorage_meta"===e)return!1;if(!_)return!1;if(void 0===t)return this.deleteKey(e);r=r||{};try{t=JSON.parse(JSON.stringify(t))}catch(e){return S(e)}return _[e]=t,c(e,r.TTL||0),l()},hasKey:function(e){return!!this.get(e)},get:function(e){return!!_&&(_.hasOwnProperty(e)&&"__simpleStorage_meta"!==e&&this.getTTL(e)?_[e]:void 0)},deleteKey:function(e){return!!_&&(e in _&&(delete _[e],c(e,0),l()))},setTTL:function(e,t){return!!_&&(c(e,t),l())},getTTL:function(e){return!!_&&(!!_.hasOwnProperty(e)&&(_.__simpleStorage_meta&&_.__simpleStorage_meta.TTL&&_.__simpleStorage_meta.TTL.expire&&_.__simpleStorage_meta.TTL.expire.hasOwnProperty(e)?Math.max(_.__simpleStorage_meta.TTL.expire[e]-+new Date||0,0)||!1:1/0))},flush:function(){if(!_)return!1;_={};try{return localStorage.removeItem("simpleStorage"),!0}catch(e){return S(e)}},index:function(){if(!_)return!1;var e,t=[];for(e in _)_.hasOwnProperty(e)&&"__simpleStorage_meta"!==e&&t.push(e);return t},storageSize:function(){return t}}});